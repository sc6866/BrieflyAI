# 🧪 BrieflyAI 测试指南

## ✅ 当前状态

- ✅ **前端服务**：正常运行，端口 `9527`
- ⚠️ **定时邮件服务**：因缺少 EmailJS 配置而重启（不影响前端使用）

## 🚀 测试步骤

### 1. 测试前端应用

#### 访问前端
打开浏览器访问：
```
http://localhost:9527
```

你应该能看到 BrieflyAI 的主界面。

#### 功能测试

1. **同步情报**
   - 点击右上角 "同步实时情报" 按钮
   - 等待 AI 生成简报（需要几秒到几十秒）
   - 检查是否成功显示简报内容

2. **查看报告**
   - 检查是否显示 "宏观决策综述"
   - 检查是否显示各个分类的情报（AI趋势、舆情分析等）
   - 切换到 "全球趋势脉冲" 标签查看热门趋势

3. **导出功能**
   - 点击 "导出研判报告" 按钮
   - 检查是否成功下载 Word 文档

4. **设置功能**
   - 点击右上角设置图标
   - 检查设置面板是否正常打开
   - 可以配置 EmailJS（前端邮件发送）

### 2. 查看服务日志

#### 前端服务日志
```powershell
# 实时查看日志
docker logs briefly-ai-pro -f

# 查看最近 50 行
docker logs briefly-ai-pro --tail 50
```

#### 定时邮件服务日志
```powershell
# 查看日志（会显示配置缺失的警告）
docker logs briefly-ai-scheduler --tail 50
```

### 3. 测试定时邮件服务（可选）

如果你需要定时邮件功能，需要：

#### 步骤 1：配置 EmailJS
1. 访问 https://www.emailjs.com/ 注册账号
2. 创建 Email Service（Gmail/Outlook 等）
3. 创建 Email Template，使用变量：
   - `{{to_email}}` - 收件人
   - `{{subject}}` - 邮件主题
   - `{{date}}` - 日期
   - `{{message_html}}` - HTML 内容
4. 获取 Public Key（Account > API Keys）

#### 步骤 2：更新 .env 文件
确保 `.env` 文件包含：
```env
API_KEY=你的_GEMINI_API_KEY
EMAIL_RECIPIENT=收件人邮箱@example.com
EMAILJS_SERVICE_ID=你的_Service_ID
EMAILJS_TEMPLATE_ID=你的_Template_ID
EMAILJS_PUBLIC_KEY=你的_Public_Key
SCHEDULE_TIME=07:00
```

#### 步骤 3：重启服务
```powershell
docker-compose restart briefly-ai-scheduler
```

#### 步骤 4：验证
```powershell
# 查看日志，应该看到 "定时邮件服务已启动"
docker logs briefly-ai-scheduler -f
```

### 4. 手动测试邮件发送

如果配置了 EmailJS，可以在前端应用中：
1. 打开设置面板
2. 填入 EmailJS 配置
3. 点击 "同步实时情报"
4. 检查是否收到邮件

## 🔍 常见问题排查

### 前端无法访问

1. **检查容器状态**
   ```powershell
   docker-compose ps
   ```
   确保 `briefly-ai-pro` 状态为 `Up`

2. **检查端口占用**
   ```powershell
   netstat -ano | findstr :9527
   ```

3. **检查日志**
   ```powershell
   docker logs briefly-ai-pro
   ```

### API Key 错误

如果同步失败，检查：
1. `.env` 文件中的 `API_KEY` 是否正确
2. API Key 是否有效且有足够的配额
3. 查看浏览器控制台（F12）的错误信息

### 定时邮件服务不断重启

这是正常的，如果不需要定时邮件功能，可以：
1. 忽略这个服务（不影响前端使用）
2. 或者停止它：
   ```powershell
   docker-compose stop briefly-ai-scheduler
   ```

## 📊 服务管理命令

```powershell
# 查看所有服务状态
docker-compose ps

# 停止所有服务
docker-compose stop

# 启动所有服务
docker-compose start

# 重启所有服务
docker-compose restart

# 停止并删除容器
docker-compose down

# 查看资源使用情况
docker stats
```

## 🎯 下一步

1. ✅ 测试前端应用基本功能
2. ✅ 验证 AI 简报生成
3. ⚙️ （可选）配置定时邮件服务
4. 🚀 准备部署到生产环境

## 💡 提示

- 前端应用可以独立运行，不依赖定时邮件服务
- 如果只需要前端功能，可以忽略定时邮件服务的重启警告
- 所有配置都保存在 `.env` 文件中，修改后需要重启服务
