# ðŸ³ fnOS Docker éƒ¨ç½²æŒ‡å—

## ðŸ“‹ å‰ç½®å‡†å¤‡

1. **ç¡®ä¿ fnOS å·²å®‰è£… Docker**
2. **å‡†å¤‡ API Key**ï¼šGemini API Keyï¼ˆå¿…éœ€ï¼‰
3. **å‡†å¤‡ EmailJS é…ç½®**ï¼ˆå¯é€‰ï¼Œå¦‚éœ€å®šæ—¶é‚®ä»¶åŠŸèƒ½ï¼‰

## ðŸš€ éƒ¨ç½²æ­¥éª¤

### æ–¹æ³• 1ï¼šé€šè¿‡ fnOS æ–‡ä»¶ç®¡ç†å™¨ï¼ˆæŽ¨èï¼‰

#### æ­¥éª¤ 1ï¼šå…‹éš†é¡¹ç›®åˆ° fnOS

1. **æ‰“å¼€ fnOS ç»ˆç«¯**ï¼ˆSSH æˆ– Web Terminalï¼‰
2. **è¿›å…¥ä½ æƒ³è¦å­˜æ”¾é¡¹ç›®çš„ç›®å½•**ï¼ˆä¾‹å¦‚ï¼š`/volume1/docker/brieflyai`ï¼‰
3. **å…‹éš†ä»“åº“**ï¼š
   ```bash
   cd /volume1/docker
   git clone https://github.com/sc6866/BrieflyAI.git brieflyai
   cd brieflyai
   ```

#### æ­¥éª¤ 2ï¼šåˆ›å»ºçŽ¯å¢ƒå˜é‡æ–‡ä»¶

åœ¨é¡¹ç›®ç›®å½•åˆ›å»º `.env` æ–‡ä»¶ï¼š

```bash
cat > .env << 'EOF'
# Gemini API Keyï¼ˆå¿…éœ€ï¼‰
API_KEY=ä½ çš„_GEMINI_API_KEY

# æœåŠ¡å™¨ç«¯å®šæ—¶é‚®ä»¶é…ç½®ï¼ˆå¯é€‰ï¼‰
EMAIL_RECIPIENT=æ”¶ä»¶äººé‚®ç®±@example.com
EMAILJS_SERVICE_ID=ä½ çš„_EmailJS_Service_ID
EMAILJS_TEMPLATE_ID=ä½ çš„_EmailJS_Template_ID
EMAILJS_PUBLIC_KEY=ä½ çš„_EmailJS_Public_Key
SCHEDULE_TIME=07:00
EOF
```

**æˆ–è€…ä½¿ç”¨æ–‡æœ¬ç¼–è¾‘å™¨**ï¼š
- åœ¨ fnOS æ–‡ä»¶ç®¡ç†å™¨ä¸­æ‰“å¼€é¡¹ç›®ç›®å½•
- åˆ›å»ºæ–°æ–‡ä»¶ `.env`
- å¤åˆ¶ä¸Šé¢çš„å†…å®¹å¹¶å¡«å…¥ä½ çš„é…ç½®

#### æ­¥éª¤ 3ï¼šé…ç½® Docker é•œåƒåŠ é€Ÿå™¨ï¼ˆå¦‚éœ€è¦ï¼‰

å¦‚æžœ fnOS æ— æ³•è®¿é—® Docker Hubï¼Œéœ€è¦é…ç½®é•œåƒåŠ é€Ÿå™¨ï¼š

1. **ç¼–è¾‘ Docker é…ç½®**ï¼ˆé€šå¸¸åœ¨ `/etc/docker/daemon.json`ï¼‰
2. **æ·»åŠ é•œåƒåŠ é€Ÿå™¨**ï¼š
   ```json
   {
     "registry-mirrors": [
       "https://docker.mirrors.ustc.edu.cn",
       "https://hub-mirror.c.163.com",
       "https://mirror.baidubce.com"
     ]
   }
   ```
3. **é‡å¯ Docker æœåŠ¡**

#### æ­¥éª¤ 4ï¼šæž„å»ºå¹¶è¿è¡Œ

åœ¨é¡¹ç›®ç›®å½•æ‰§è¡Œï¼š

```bash
# æž„å»ºå¹¶å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker-compose up -d --build

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f
```

#### æ­¥éª¤ 5ï¼šè®¿é—®åº”ç”¨

- **å‰ç«¯åº”ç”¨**ï¼š`http://ä½ çš„fnOS_IP:9527`
- **æŸ¥çœ‹æœåŠ¡çŠ¶æ€**ï¼š`docker-compose ps`
- **æŸ¥çœ‹æ—¥å¿—**ï¼š`docker-compose logs briefly-ai-pro -f`

### æ–¹æ³• 2ï¼šé€šè¿‡ fnOS Docker å›¾å½¢ç•Œé¢

#### æ­¥éª¤ 1ï¼šå‡†å¤‡é¡¹ç›®æ–‡ä»¶

1. **åœ¨ fnOS æ–‡ä»¶ç®¡ç†å™¨ä¸­åˆ›å»ºç›®å½•**ï¼š`/volume1/docker/brieflyai`
2. **ä¸Šä¼ é¡¹ç›®æ–‡ä»¶**æˆ–ä½¿ç”¨ Git å…‹éš†

#### æ­¥éª¤ 2ï¼šåˆ›å»º .env æ–‡ä»¶

åœ¨æ–‡ä»¶ç®¡ç†å™¨ä¸­åˆ›å»º `.env` æ–‡ä»¶å¹¶å¡«å…¥é…ç½®ã€‚

#### æ­¥éª¤ 3ï¼šä½¿ç”¨ Docker Compose

1. **æ‰“å¼€ fnOS Docker ç®¡ç†ç•Œé¢**
2. **è¿›å…¥ Compose æˆ– Stack ç®¡ç†**
3. **åˆ›å»ºæ–°çš„ Stack**ï¼š
   - åç§°ï¼š`brieflyai`
   - é€‰æ‹©é¡¹ç›®ç›®å½•ï¼š`/volume1/docker/brieflyai`
   - é€‰æ‹© `docker-compose.yml` æ–‡ä»¶
4. **é…ç½®çŽ¯å¢ƒå˜é‡**ï¼ˆå¦‚æžœç•Œé¢æ”¯æŒï¼‰
5. **éƒ¨ç½²å¹¶å¯åŠ¨**

## ðŸ”§ å¸¸è§é—®é¢˜æŽ’æŸ¥

### 1. æ— æ³•æ‹‰å–é•œåƒ

**è§£å†³æ–¹æ¡ˆ**ï¼š
- é…ç½® Docker é•œåƒåŠ é€Ÿå™¨ï¼ˆè§æ­¥éª¤ 3ï¼‰
- æˆ–ä½¿ç”¨ VPN/ä»£ç†

### 2. ç«¯å£å†²çª

**æ£€æŸ¥ç«¯å£å ç”¨**ï¼š
```bash
netstat -tuln | grep 9527
```

**ä¿®æ”¹ç«¯å£**ï¼ˆå¦‚éœ€è¦ï¼‰ï¼š
ç¼–è¾‘ `docker-compose.yml`ï¼Œå°† `9527:80` æ”¹ä¸ºå…¶ä»–ç«¯å£ï¼Œå¦‚ `9528:80`

### 3. æƒé™é—®é¢˜

**ç¡®ä¿ Docker æœ‰æƒé™è®¿é—®é¡¹ç›®ç›®å½•**ï¼š
```bash
chmod -R 755 /volume1/docker/brieflyai
```

### 4. æŸ¥çœ‹è¯¦ç»†æ—¥å¿—

```bash
# æŸ¥çœ‹æ‰€æœ‰æœåŠ¡æ—¥å¿—
docker-compose logs -f

# æŸ¥çœ‹å‰ç«¯æœåŠ¡æ—¥å¿—
docker-compose logs briefly-ai-pro -f

# æŸ¥çœ‹å®šæ—¶é‚®ä»¶æœåŠ¡æ—¥å¿—
docker-compose logs briefly-ai-scheduler -f
```

## ðŸ“Š æœåŠ¡ç®¡ç†å‘½ä»¤

```bash
# å¯åŠ¨æœåŠ¡
docker-compose up -d

# åœæ­¢æœåŠ¡
docker-compose stop

# é‡å¯æœåŠ¡
docker-compose restart

# åœæ­¢å¹¶åˆ é™¤å®¹å™¨
docker-compose down

# é‡æ–°æž„å»ºå¹¶å¯åŠ¨
docker-compose up -d --build

# æŸ¥çœ‹èµ„æºä½¿ç”¨
docker stats
```

## âœ… éªŒè¯éƒ¨ç½²

1. **æ£€æŸ¥å®¹å™¨çŠ¶æ€**ï¼š
   ```bash
   docker-compose ps
   ```
   åº”è¯¥çœ‹åˆ°ä¸¤ä¸ªå®¹å™¨éƒ½åœ¨è¿è¡Œï¼š
   - `briefly-ai-pro` (å‰ç«¯)
   - `briefly-ai-scheduler` (å®šæ—¶é‚®ä»¶)

2. **è®¿é—®å‰ç«¯**ï¼š
   æ‰“å¼€æµè§ˆå™¨è®¿é—® `http://ä½ çš„fnOS_IP:9527`

3. **æµ‹è¯•åŠŸèƒ½**ï¼š
   - ç‚¹å‡»"åŒæ­¥å®žæ—¶æƒ…æŠ¥"æµ‹è¯• AI ç®€æŠ¥ç”Ÿæˆ
   - åˆ‡æ¢åˆ°"å…¨çƒè¶‹åŠ¿è„‰å†²"æ ‡ç­¾
   - ç‚¹å‡»"åˆ·æ–°çƒ­ç‚¹"æµ‹è¯•å¼‚æ­¥åˆ·æ–°åŠŸèƒ½

## ðŸ” å®‰å…¨å»ºè®®

1. **ä¿æŠ¤ .env æ–‡ä»¶**ï¼šç¡®ä¿åªæœ‰æŽˆæƒç”¨æˆ·å¯ä»¥è®¿é—®
2. **é˜²ç«å¢™é…ç½®**ï¼šåªå¼€æ”¾å¿…è¦çš„ç«¯å£ï¼ˆ9527ï¼‰
3. **å®šæœŸæ›´æ–°**ï¼šä½¿ç”¨ `git pull` èŽ·å–æœ€æ–°ä»£ç 

## ðŸ“ æ›´æ–°é¡¹ç›®

```bash
cd /volume1/docker/brieflyai
git pull
docker-compose build
docker-compose up -d
```

## ðŸ’¡ æç¤º

- fnOS é€šå¸¸ä½¿ç”¨ `/volume1` ä½œä¸ºä¸»å­˜å‚¨å·
- ç¡®ä¿ Docker æœåŠ¡å·²å¯åŠ¨
- å¦‚æžœé‡åˆ°é—®é¢˜ï¼ŒæŸ¥çœ‹æ—¥å¿—æ˜¯æœ€å¿«çš„æŽ’æŸ¥æ–¹æ³•
